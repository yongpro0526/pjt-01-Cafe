<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Java Coffee</title>

    <!-- ë¡œê·¸ì¸ ì—¬ë¶€ JS ì „ë‹¬ -->
    <th:block th:if="${IS_LOGGED_IN}">
        <script th:inline="javascript">
            const IS_LOGGED_IN = true;
            const USER_ID = [[${#authentication.name}]];
        </script>
    </th:block>

    <th:block th:if="${!IS_LOGGED_IN}">
        <script>
            const IS_LOGGED_IN = false;
            const USER_ID = null;
        </script>
    </th:block>

    <!-- ë¡œê·¸ì¸ ì‹¤íŒ¨ ì‹œ ë©”ì‹œì§€ -->
    <script th:if="${loginErrorMessage}">
        alert('[[${loginErrorMessage}]]');
    </script>

    <!-- ë¡œê·¸ì¸ ì„±ê³µ ì‹œ ë©”ì‹œì§€ -->
    <script th:if="${loginSuccessType != null}">
        alert('[[${loginMemberName}]]ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤!');
    </script>

    <!-- ìŠ¤íƒ¬í”„/ì¿ í° ë°ì´í„° -->
    <script th:inline="javascript">
        const rewardData = /*[[${reward}]]*/ {stamps:0, coupons:0};
        document.addEventListener('DOMContentLoaded', () => {
            const stampEl = document.getElementById('stamp-count');
            const couponEl = document.getElementById('coupon-count');

            stampEl.innerText = `ìŠ¤íƒ¬í”„ ${rewardData.stamps}/10`;
            couponEl.innerText = `ì¿ í° ${rewardData.coupons}`;
        });
    </script>
</head>

<th:block th:replace="~{./include/userBaseLayout :: setContent( ~{:: .wrap} ) }">

    <div class="wrap">

        <!-- ì„œë²„ì—ì„œ ì „ë‹¬ë°›ëŠ” ë‹¨ì¼ ë©”ì‹œì§€ -->
        <script th:if="${msg}">
            alert(`[[${msg}]]`);
        </script>

        <!-- ë©”ì¸ ë°°ë„ˆ -->
        <div class="main-banner">
            <img src="/images/ë©”ì¸ë°°ë„ˆêµì²´.png" alt="ë©”ì¸ë°°ë„ˆ">
        </div>

        <main class="container">

            <!-- ì´ì „ ì£¼ë¬¸ë‚´ì—­ -->
            <section class="previous-orders">
                <div class="previous-orders-header">
                    <h2 class="previous-orders-title">ì´ì „ ì£¼ë¬¸ë‚´ì—­</h2>

                    <!-- ğŸ”¥ ê³ ì¹¨: /home/order_history ë¡œ ì´ë™ -->
                    <a th:href="@{/home/order_history}" class="previous-orders-more login-required">ë”ë³´ê¸°</a>
                </div>

                <div class="previous-orders-grid">
                    <th:block th:if="${#lists.isEmpty(recentOrders)}">
                        <p style="font-size:14px; color:#555">ìµœê·¼ ì£¼ë¬¸ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                    </th:block>
                    <th:block th:each="item : ${recentOrders}">
                        <a th:href="@{'/home/order_history'}" class="previous-order-item login-required">
                            <img th:src="@{'/upload/menuImg/' + ${item.menuImg}}"
                                 th:alt="${item.menuName}"
                                 class="menu-image">
                            <p class="item-name" th:text="${item.menuName}"></p>
                        </a>
                    </th:block>
                </div>
            </section>

            <!-- ìŠ¤íƒ¬í”„/ì¿ í° ì˜ì—­ -->
            <section class="reward-section">
                <div class="reward-item">
                    <span class="icon stamp-icon"><i class="fa-solid fa-stamp"></i></span>
                    <span class="text" id="stamp-count">ìŠ¤íƒ¬í”„ 0/10</span>
                </div>

                <div class="divider"></div>

                <div class="reward-item">
                    <span class="icon coupon-icon">ğŸŸï¸</span>
                    <span class="text" id="coupon-count">ì¿ í° 0</span>
                </div>
            </section>


            <div class="region">
                <span class="region-label">êµ¬ë§¤í•  ì§€ì ì„ ì„ íƒí•˜ì„¸ìš”.</span>
                <form action="region">
                    <select name="userRegion" id="userRegion">
                        <option value="none" disabled selected hidden>ì§€ì  ì„ íƒ</option>
                        <option value="ê°•ë‚¨ì¤‘ì•™ì ">ìë°”ë¹ˆì¹´í˜ ê°•ë‚¨ì¤‘ì•™ì </option>
                        <option value="ì—­ì‚¼ì¤‘ì•™ì ">ìë°”ë¹ˆì¹´í˜ ì—­ì‚¼ì¤‘ì•™ì </option>
                        <option value="ì„ ë¦‰ì¤‘ì•™ì ">ìë°”ë¹ˆì¹´í˜ ì„ ë¦‰ì¤‘ì•™ì </option>
                    </select>
                </form>
            </div>

        </main>

    </div>

</th:block>
</html>